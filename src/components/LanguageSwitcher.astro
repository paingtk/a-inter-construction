---
interface Props {
  currentLang: string;
  currentPath: string;
}

const { currentLang, currentPath } = Astro.props;

const langs = [
  { code: 'th', flag: 'ðŸ‡¹ðŸ‡­', label: 'à¹„à¸—à¸¢' },
  { code: 'en', flag: 'ðŸ‡¬ðŸ‡§', label: 'English' },
];

function getLocalizedPath(path: string, targetLang: string) {
  // Remove current language prefix if exists
  let cleanPath = path;
  if (path.startsWith('/en')) {
    cleanPath = path.replace('/en', '') || '/';
  }

  // Add new language prefix (except for default Thai)
  if (targetLang === 'th') {
    return cleanPath;
  }
  return `/${targetLang}${cleanPath}`;
}
---

<div class="lang-switcher">
  {langs.map(({ code, flag, label }) => (
    <a
      href={getLocalizedPath(currentPath, code)}
      class:list={["lang-btn", { active: currentLang === code }]}
      aria-label={label}
      title={label}
    >
      <span class="flag">{flag}</span>
    </a>
  ))}
</div>

<style>
  .lang-switcher {
    display: flex;
    gap: 0.375rem;
    margin-left: 1.5rem;
  }

  .lang-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 2px solid transparent;
    transition: all 0.2s ease;
  }

  .lang-btn:hover {
    border-color: var(--color-border);
  }

  .lang-btn.active {
    border-color: var(--color-primary);
  }

  .flag {
    font-size: 1.25rem;
    line-height: 1;
  }
</style>
